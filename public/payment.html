<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Payment</title>
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <header>
        <h1>Payment for Artwork</h1>
    </header>

    <main>
        <section id="payment">
            <h2>Artwork Details</h2>
            <p id="artwork-title"></p>
            <p id="artwork-price"></p>

            <h2>Complete Payment</h2>
            <form id="payment-form">
                <!-- Payment Date -->
                <label for="payment-date">Payment Date:</label>
                <input type="date" id="payment-date" name="payment-date">

                <!-- Amount (Read-Only) -->
                <label for="payment-amount">Amount:</label>
                <input type="number" id="payment-amount" name="payment-amount" readonly>

                <!-- Cardholder's Name -->
                <label for="card-name">Cardholder Name:</label>
                <input type="text" id="card-name" name="card-name" required>

                <!-- Card Number -->
                <label for="card-number">Card Number:</label>
                <input type="text" id="card-number" name="card-number" required minlength="16" maxlength="16" pattern="\d{16}" placeholder="1234 5678 9101 1121">

                <!-- Expiration Date -->
                <label for="card-expiration">Expiration Date (MM/YY):</label>
                <input type="text" id="card-expiration" name="card-expiration" required placeholder="MM/YY" pattern="\d{2}/\d{2}">

                <!-- CVV -->
                <label for="card-cvv">CVV:</label>
                <input type="text" id="card-cvv" name="card-cvv" required minlength="3" maxlength="4" pattern="\d{3,4}" placeholder="123">

                <button type="button" onclick="processPayment()">Submit Payment</button>
            </form>
        </section>
    </main>

    <footer>
        <p>&copy; 2024 Digital Art Gallery</p>
    </footer>

    <script>
        // Extract artwork details from the URL query parameters
        const urlParams = new URLSearchParams(window.location.search);
        const title = urlParams.get('title');
        const price = urlParams.get('price');

        // Populate the page with artwork details
        document.getElementById('artwork-title').textContent = `Title: ${title}`;
        document.getElementById('artwork-price').textContent = `Price: $${price}`;
        document.getElementById('payment-amount').value = price;

        function processPayment() {
            const paymentDate = document.getElementById('payment-date').value;
            const paymentAmount = document.getElementById('payment-amount').value;
            const cardName = document.getElementById('card-name').value;
            const cardNumber = document.getElementById('card-number').value;
            const cardExpiration = document.getElementById('card-expiration').value;
            const cardCvv = document.getElementById('card-cvv').value;

            const paymentData = {
                payment_date: paymentDate,
                payment_price: parseFloat(paymentAmount),
                artwork_title: title,  // Include the title of the artwork being purchased
                card_name: cardName,
                card_number: cardNumber,
                card_expiration: cardExpiration,
                card_cvv: cardCvv
            };

            // Send payment data to the backend (API call)
            fetch('http://your-backend-url/api/payments', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json'
                },
                body: JSON.stringify(paymentData)
            })
            .then(response => {
                if (response.ok) {
                    return response.json();  // Get the JSON data from the response
                } else {
                    throw new Error('Failed to process payment');
                }
            })
            .then(data => {
                console.log('Payment processed:', data);
                alert('Payment successful!');
                // Optionally, redirect to a confirmation page or back to the gallery
                window.location.href = 'confirmation.html'; 
            })
            .catch(error => {
                console.error('Error processing payment:', error);
            });
        }
    </script>
</body>
</html>
